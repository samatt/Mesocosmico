<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Mesocosmico Recipe Maker</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.3.0/snap.svg-min.js"> </script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	
	<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
	<!-- <link rel="stylesheet" href="http://localhost:3000/countries.css"> -->
	<link rel="stylesheet" href="http://45.55.165.85:3000/countries.css">
	<style>
/*		@import url(http://fonts.googleapis.com/css?family=Hind:400,700);
		#svg{
			width:1440px;
			height:1000px;	
		}
		.object	{
			fill: blue;
		}

		.canvas{
			background-color :red;
			color:blue;
		}
		.text{
			fill:RGBA(199, 104, 202, 1);
			font-family: 'Hind', sans-serif;
			font-size:170px;
		}*/
	</style>
	
	<script src="http://45.55.165.85:3000/patternMaker.js"></script>
	 <!-- // <script src="http://localhost:3000/patternMaker.js"></script> -->
	<script>
		var params = {
			"icon_viewbox" : "0 0 128 128",
			"w" : 1440,
			"h" : 1000,
			"class":"canvas",
		}
		
		var text;
		var defaultViewBox ="0 0 128 128";
		var wid
		categories = {}
		var icons = {};
		var p;
		var s,scope; 
		$( document ).ready(function(){
			// var svg = Snap("#svg");	
			// svg.addClass("canvas");
			 var w = $(window).width();
			 var h = $(window).height();
			 $('#svg').css('width', w);
			 $('#svg').css('height', h);
			 var request = $.ajax({
				type: "GET",
				url: "/getcategoriescsv",
				})
				.done(function(data) {
					$('#names').empty()
					$('#names').append("random");
					p= patternMaker(data,'svg');
					p.generate();
				})
		});

		$(window).bind( 'hashchange', function(e) { 
	    	var anchor = document.location.hash;
	            p.clear();
	            countries = anchor.replace("#","").split('-')
	            var request = $.ajax({
					type: "POST",
					url: "/gettradeicons",
					data:JSON.stringify({"src":countries[0],"dst":countries[1]}),
					dataType: 'JSON',
					contentType: 'application/json' 
				})
				.done(function(data) {
					if(data == "Bogus"){
						$('#names').empty()
						$('#names').append("didnt work. try again");
					}
					else{
						var ids = JSON.parse(data)
						$('#names').empty()
						$('#names').append("src: "+countries[0]+" dst: "+countries[1]);
						p.generateFromList(ids,countries[0],countries[1]);	
					}
					
				})
				.fail(function() {
					console.log( "error" );
					$('#names').empty()
					$('#names').append("didnt work. try again");
				})
    	});
		function getRandomInt(min, max) {
		  return Math.floor(Math.random() * (max - min)) + min;
		}
	</script>
</head>


<body>
<p id="names"></p>
<svg id="svg">
</svg>
<!-- <button type="button" onclick="loadSvg()" class="pure-button pure-button-primary pure-u-3-3">Get Arms Categories</button>	 -->
	
</body>
</html>
